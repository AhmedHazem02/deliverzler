# Ù†Ø¸Ø§Ù… Ø§Ø³ØªØ¹Ø§Ø¯Ø© ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ÙˆØ§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ

## ğŸ“‹ Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø©

ØªÙ… ØªØ·ÙˆÙŠØ± Ù†Ø¸Ø§Ù… Ù…ØªÙƒØ§Ù…Ù„ Ù„Ø§Ø³ØªØ¹Ø§Ø¯Ø© ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ÙˆØ§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ù…Ø¹ Ø¯Ø¹Ù… ÙƒØ§Ù…Ù„ Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© ÙˆØ§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©ØŒ ÙˆØªØµÙ…ÙŠÙ… Ù…ØªØ¬Ø§ÙˆØ¨ Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø¬Ù‡Ø²Ø© (Mobile, Tablet, Web).

## âœ¨ Ø§Ù„Ù…ÙŠØ²Ø§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©

### 1. Ø§Ø³ØªØ¹Ø§Ø¯Ø© ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± (Forgot Password)
- âœ… ØµÙØ­Ø© Ù…Ø®ØµØµØ© Ù„Ø¥Ø±Ø³Ø§Ù„ Ø±Ø§Ø¨Ø· Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±
- âœ… Ù†Ø¸Ø§Ù… Rate Limiting (60 Ø«Ø§Ù†ÙŠØ© Ø¨ÙŠÙ† ÙƒÙ„ Ø·Ù„Ø¨)
- âœ… Ø¹Ø¯Ø§Ø¯ ØªÙ†Ø§Ø²Ù„ÙŠ ÙŠØ¹Ø±Ø¶ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ
- âœ… Ø±Ø³Ø§Ø¦Ù„ Ù†Ø¬Ø§Ø­/Ø®Ø·Ø£ ÙˆØ§Ø¶Ø­Ø© ÙˆÙ…ÙØµÙ„Ø©
- âœ… ØªØµÙ…ÙŠÙ… responsive (Compact Ù„Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ØŒ Medium Ù„Ù„ØªØ§Ø¨Ù„Øª)
- âœ… Ø¯Ø¹Ù… ÙƒØ§Ù…Ù„ Ù„Ù„Ø¹Ø±Ø¨ÙŠØ© ÙˆØ§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©

### 2. Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ (Email Verification)
- âœ… ÙØ­Øµ ØªÙ„Ù‚Ø§Ø¦ÙŠ ÙƒÙ„ 5 Ø«ÙˆØ§Ù† Ù„Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„
- âœ… ÙƒØ´Ù Ø°ÙƒÙŠ Ø¹Ù†Ø¯ Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„ØªØ·Ø¨ÙŠÙ‚ (WidgetsBindingObserver)
- âœ… Ø¥Ø¹Ø§Ø¯Ø© Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ù…Ø¹ Ù†Ø¸Ø§Ù… cooldown
- âœ… Ø²Ø± "Ù‡Ù„ Ø£Ø¯Ø®Ù„Øª Ø¥ÙŠÙ…ÙŠÙ„ Ø®Ø§Ø·Ø¦ØŸ" Ù„Ù„Ø®Ø±ÙˆØ¬
- âœ… ÙØ­Øµ Ù…Ù† Ø§Ù„Ø³ÙŠØ±ÙØ± Ù…Ø¨Ø§Ø´Ø±Ø© (Server-side verification)
- âœ… Ø±Ø³Ø§Ø¦Ù„ ØªÙˆØ¶ÙŠØ­ÙŠØ© ÙˆÙ†ØµØ§Ø¦Ø­ (ØªØ­Ù‚Ù‚ Ù…Ù† spam)

### 3. Ø§Ù„ØªÙƒØ§Ù…Ù„ Ø§Ù„ÙƒØ§Ù…Ù„ Ù…Ø¹ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
- âœ… Ø§Ù„ØªØ³Ø¬ÙŠÙ„ ÙŠØ±Ø³Ù„ verification email ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹
- âœ… Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ Ù„Ù„Ù€ verification screen Ø¨Ø¹Ø¯ Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ù…Ø¨Ø§Ø´Ø±Ø©
- âœ… CheckAuth ÙŠØªØ­Ù‚Ù‚ Ù…Ù† Email Verification Ù‚Ø¨Ù„ Ø§Ù„Ø³Ù…Ø§Ø­ Ø¨Ø§Ù„Ø¯Ø®ÙˆÙ„
- âœ… Router ÙŠØªØ¹Ø§Ù…Ù„ Ù…Ø¹ EmailNotVerifiedException
- âœ… Ø²Ø± "Forgot Password?" ÙÙŠ ØµÙØ­Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„

## ğŸ—ï¸ Ù…Ø¹Ù…Ø§Ø±ÙŠØ© Ø§Ù„Ù†Ø¸Ø§Ù…

### Clean Architecture
```
lib/
â”œâ”€â”€ auth/
â”‚   â”œâ”€â”€ domain/                          # Ø·Ø¨Ù‚Ø© Ø§Ù„Ù†Ø·Ø§Ù‚
â”‚   â”‚   â”œâ”€â”€ auth_failure.dart           # Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ø£Ø®Ø·Ø§Ø¡ (Freezed)
â”‚   â”‚   â””â”€â”€ email_not_verified_exception.dart
â”‚   â”œâ”€â”€ infrastructure/                  # Ø·Ø¨Ù‚Ø© Ø§Ù„Ø¨Ù†ÙŠØ© Ø§Ù„ØªØ­ØªÙŠØ©
â”‚   â”‚   â”œâ”€â”€ data_sources/
â”‚   â”‚   â”‚   â””â”€â”€ auth_remote_data_source.dart
â”‚   â”‚   â””â”€â”€ repos/
â”‚   â”‚       â””â”€â”€ auth_repo.dart          # Repository Ù…Ø¹ Either pattern
â”‚   â””â”€â”€ presentation/                    # Ø·Ø¨Ù‚Ø© Ø§Ù„Ø¹Ø±Ø¶
â”‚       â”œâ”€â”€ providers/
â”‚       â”‚   â”œâ”€â”€ forgot_password_provider.dart
â”‚       â”‚   â””â”€â”€ email_verification_provider.dart
â”‚       â”œâ”€â”€ components/
â”‚       â”‚   â””â”€â”€ forgot_password_form_component.dart
â”‚       â””â”€â”€ screens/
â”‚           â”œâ”€â”€ forgot_password_screen/
â”‚           â”‚   â”œâ”€â”€ forgot_password_screen.dart
â”‚           â”‚   â”œâ”€â”€ forgot_password_screen_compact.dart
â”‚           â”‚   â””â”€â”€ forgot_password_screen_medium.dart
â”‚           â””â”€â”€ email_verification_screen/
â”‚               â””â”€â”€ email_verification_screen.dart
```

## ğŸ”§ Ø§Ù„ØªÙ‚Ù†ÙŠØ§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø©

### State Management & Architecture
- **Riverpod** - State management Ù…Ø¹ keepAlive
- **Freezed** - Immutable data classes Ùˆ union types
- **fpdart** - Functional programming (Either, Option, Unit)

### Navigation & UI
- **go_router** - Type-safe navigation Ù…Ø¹ TypedGoRoute
- **WindowClassLayout** - Responsive design
- **Material Design 3** - Ù…Ø¹ Ø¯Ø¹Ù… RTL

### Firebase & Backend
- **Firebase Authentication** - Email/Password authentication
- **Email Verification API** - Server-side verification
- **Password Reset API** - Ø±Ø§Ø¨Ø· Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±

### Utilities
- **WidgetsBindingObserver** - Lifecycle management
- **Timer.periodic** - Periodic checks
- **ARB files** - Internationalization (i18n)

## ğŸ“ Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ

### 1. Forgot Password Provider

```dart
import 'package:freezed_annotation/freezed_annotation.dart';

part 'forgot_password_provider.freezed.dart';
part 'forgot_password_provider.g.dart';

@freezed
class ForgotPasswordState with _$ForgotPasswordState {
  const factory ForgotPasswordState({
    DateTime? lastSentTime,
    @Default(false) bool emailSent,
  }) = _ForgotPasswordState;
}

@riverpod
class ForgotPassword extends _$ForgotPassword {
  static const cooldownDuration = Duration(seconds: 60);

  @override
  ForgotPasswordState build() => const ForgotPasswordState();

  int get secondsRemaining {
    if (state.lastSentTime == null) return 0;
    final elapsed = DateTime.now().difference(state.lastSentTime!);
    final remaining = cooldownDuration.inSeconds - elapsed.inSeconds;
    return remaining > 0 ? remaining : 0;
  }

  bool get canSend => secondsRemaining <= 0;

  Future<Either<AuthFailure, Unit>> sendPasswordResetEmail(String email) async {
    if (!canSend) return left(const AuthFailure.tooManyRequests());

    final result = await ref.read(authRepoProvider).sendPasswordResetEmail(email);

    return result.fold(
      (failure) => left(failure),
      (_) {
        state = ForgotPasswordState(
          lastSentTime: DateTime.now(),
          emailSent: true,
        );
        return right(unit);
      },
    );
  }
}
```

### 2. Email Verification Provider

```dart
@riverpod
class EmailVerification extends _$EmailVerification {
  Timer? _periodicTimer;

  @override
  EmailVerificationState build(String email) {
    _startPeriodicCheck();
    return EmailVerificationState(email: email);
  }

  void _startPeriodicCheck() {
    _periodicTimer = Timer.periodic(
      const Duration(seconds: 5),
      (_) => checkVerificationStatus(silent: true),
    );
    
    // Cleanup timer on dispose
    ref.onDispose(() {
      _periodicTimer?.cancel();
    });
  }

  Future<void> checkVerificationStatus({bool silent = false}) async {
    if (!silent) {
      state = state.copyWith(isChecking: true, errorMessage: null);
    }

    final result = await ref.read(authRepoProvider).checkEmailVerified();

    result.fold(
      (failure) {
        if (!silent) {
          state = state.copyWith(
            isChecking: false,
            errorMessage: _mapFailureToMessage(failure),
          );
        }
      },
      (isVerified) {
        state = state.copyWith(
          isChecking: false,
          isVerified: isVerified,
          errorMessage: null,
        );
        
        if (isVerified) {
          _periodicTimer?.cancel();
        }
      },
    );
  }

  Future<void> resendVerificationEmail() async {
    if (!canResend) return;

    state = state.copyWith(errorMessage: null);

    final result = await ref.read(authRepoProvider).sendEmailVerification();

    result.fold(
      (failure) {
        state = state.copyWith(
          errorMessage: _mapFailureToMessage(failure),
        );
      },
      (_) {
        state = state.copyWith(
          lastResendTime: DateTime.now(),
          errorMessage: null,
        );
      },
    );
  }

  Future<void> signOutAndGoBack(BuildContext context) async {
    await ref.read(authRepoProvider).signOut();
    if (context.mounted) {
      const SignInRoute().go(context);
    }
  }
}
```

### 3. Email Verification Screen Ù…Ø¹ Lifecycle Detection

```dart
class _EmailVerificationScreenState extends ConsumerState<EmailVerificationScreen>
    with WidgetsBindingObserver {
  
  @override
  void initState() {
    super.initState();
    WidgetsBinding.instance.addObserver(this);
  }

  @override
  void dispose() {
    WidgetsBinding.instance.removeObserver(this);
    super.dispose();
  }

  @override
  void didChangeAppLifecycleState(AppLifecycleState state) {
    // Ø§Ù„ÙƒØ´Ù Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ Ø¹Ù†Ø¯ Ø§Ù„Ø¹ÙˆØ¯Ø© Ù…Ù† ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„
    if (state == AppLifecycleState.resumed) {
      ref.read(emailVerificationProvider(widget.email).notifier)
        .checkVerificationStatus();
    }
  }

  @override
  Widget build(BuildContext context) {
    final verificationState = ref.watch(emailVerificationProvider(widget.email));
    final notifier = ref.watch(emailVerificationProvider(widget.email).notifier);

    // Ø§Ù„Ø§Ø³ØªÙ…Ø§Ø¹ Ù„Ù„ØªØºÙŠÙŠØ±Ø§Øª ÙˆØ¥Ø¸Ù‡Ø§Ø± Toast
    ref.listen(emailVerificationProvider(widget.email), (previous, next) {
      if (next.isVerified && !previous!.isVerified) {
        Toasts.showTitledToast(
          context,
          title: tr(context).success,
          description: tr(context).emailVerifiedSuccessfully,
        );
        
        // Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ Ù„ØµÙØ­Ø© Home
        const ApplicationStatusGateRoute().go(context);
      }

      if (next.errorMessage != null && next.errorMessage != previous?.errorMessage) {
        Toasts.showTitledToast(
          context,
          title: tr(context).ops_err,
          description: next.errorMessage!,
        );
      }
    });

    // ... Ø¨Ø§Ù‚ÙŠ UI
  }
}
```

### 4. Firebase Auth Methods

```dart
// ÙÙŠ FirebaseAuthFacade
Future<void> sendPasswordResetEmail({required String email}) async {
  await _errorHandler(() => _firebaseAuth.sendPasswordResetEmail(email: email));
}

Future<void> sendEmailVerification() async {
  final user = _firebaseAuth.currentUser;
  if (user == null) {
    throw const ServerException(type: ServerExceptionType.general);
  }
  if (user.emailVerified) return; // Already verified
  
  await _errorHandler(() => user.sendEmailVerification());
}

Future<void> reloadUser() async {
  final user = _firebaseAuth.currentUser;
  if (user == null) {
    throw const ServerException(type: ServerExceptionType.general);
  }
  
  await _errorHandler(() => user.reload());
}

Future<bool> isEmailVerified() async {
  await reloadUser(); // âš ï¸ Ù…Ù‡Ù…: Server-side check Ù„ØªØ¬Ù†Ø¨ Ø§Ù„Ù€ cache
  return _firebaseAuth.currentUser?.emailVerified ?? false;
}
```

### 5. Router Integration

```dart
// ÙÙŠ app_router.dart
redirect: (BuildContext context, GoRouterState state) {
  // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† EmailNotVerifiedException
  final checkAuthState = ref.read(checkAuthProvider);
  if (checkAuthState.hasError &&
      checkAuthState.error is EmailNotVerifiedException) {
    final exception = checkAuthState.error as EmailNotVerifiedException;
    final email = exception.email ?? '';
    
    if (email.isNotEmpty &&
        state.matchedLocation != EmailVerificationRoute(email: email).location) {
      return EmailVerificationRoute(email: email).location;
    }
  }
  
  // ... Ø¨Ø§Ù‚ÙŠ redirect logic
}
```

## ğŸŒ Ø§Ù„ØªØ±Ø¬Ù…Ø§Øª

ØªÙ… Ø¥Ø¶Ø§ÙØ© 27+ Ù…ÙØªØ§Ø­ ØªØ±Ø¬Ù…Ø© Ø¬Ø¯ÙŠØ¯ Ø¨Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© ÙˆØ§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©:

```dart
// Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© (app_en.arb)
"forgotPassword": "Forgot Password?",
"resetPassword": "Reset Password",
"enterEmailForReset": "Enter your email to receive a password reset link",
"sendResetLink": "Send Reset Link",
"checkEmailForResetLink": "Check your email for the reset link",
"resendIn": "Resend in {seconds} seconds",
"verifyYourEmail": "Verify Your Email",
"verificationEmailSent": "We've sent a verification email to:",
"checkYourEmail": "Please check your email and click the verification link",
"emailVerifiedSuccessfully": "Email verified successfully!",
"wrongEmailQuestion": "Wrong Email?",
"resendVerificationEmail": "Resend Verification Email",
"checkingVerificationStatus": "Checking verification status...",
"checkSpamFolder": "Tip: Check your spam folder if you don't see the email",
// ... ÙˆØ§Ù„Ù…Ø²ÙŠØ¯

// Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© (app_ar.arb)
"forgotPassword": "Ù‡Ù„ Ù†Ø³ÙŠØª ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±ØŸ",
"resetPassword": "Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±",
"enterEmailForReset": "Ø£Ø¯Ø®Ù„ Ø¨Ø±ÙŠØ¯Ùƒ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ù„ØªÙ„Ù‚ÙŠ Ø±Ø§Ø¨Ø· Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±",
"sendResetLink": "Ø¥Ø±Ø³Ø§Ù„ Ø±Ø§Ø¨Ø· Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ¹ÙŠÙŠÙ†",
"checkEmailForResetLink": "ØªØ­Ù‚Ù‚ Ù…Ù† Ø¨Ø±ÙŠØ¯Ùƒ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø±Ø§Ø¨Ø· Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ¹ÙŠÙŠÙ†",
"resendIn": "Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ Ø¨Ø¹Ø¯ {seconds} Ø«Ø§Ù†ÙŠØ©",
"verifyYourEmail": "ØªØ­Ù‚Ù‚ Ù…Ù† Ø¨Ø±ÙŠØ¯Ùƒ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ",
"verificationEmailSent": "Ù„Ù‚Ø¯ Ø£Ø±Ø³Ù„Ù†Ø§ Ø±Ø³Ø§Ù„Ø© ØªØ­Ù‚Ù‚ Ø¥Ù„Ù‰:",
"checkYourEmail": "ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø¨Ø±ÙŠØ¯Ùƒ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ ÙˆØ§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø±Ø§Ø¨Ø· Ø§Ù„ØªØ­Ù‚Ù‚",
"emailVerifiedSuccessfully": "ØªÙ… Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ø¨Ù†Ø¬Ø§Ø­!",
"wrongEmailQuestion": "Ù‡Ù„ Ø£Ø¯Ø®Ù„Øª Ø¥ÙŠÙ…ÙŠÙ„ Ø®Ø§Ø·Ø¦ØŸ",
"resendVerificationEmail": "Ø¥Ø¹Ø§Ø¯Ø© Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø© Ø§Ù„ØªØ­Ù‚Ù‚",
"checkingVerificationStatus": "Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø­Ø§Ù„Ø© Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ...",
"checkSpamFolder": "Ù†ØµÙŠØ­Ø©: ØªØ­Ù‚Ù‚ Ù…Ù† Ù…Ø¬Ù„Ø¯ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ ØºÙŠØ± Ø§Ù„Ù…Ø±ØºÙˆØ¨ ÙÙŠÙ‡Ø§ Ø¥Ø°Ø§ Ù„Ù… ØªØ¬Ø¯ Ø§Ù„Ø±Ø³Ø§Ù„Ø©",
// ... ÙˆØ§Ù„Ù…Ø²ÙŠØ¯
```

## ğŸ”„ ØªØ¯ÙÙ‚ Ø§Ù„Ø¹Ù…Ù„ (User Flow)

### 1. Forgot Password Flow
```
User Ø¹Ù„Ù‰ ØµÙØ­Ø© Login
    â†“
ÙŠØ¶ØºØ· "Forgot Password?"
    â†“
ÙŠØ¯Ø®Ù„ Ø¥Ù„Ù‰ ForgotPasswordScreen
    â†“
ÙŠØ¯Ø®Ù„ Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„ ÙˆÙŠØ¶ØºØ· "Send Reset Link"
    â†“
Provider ÙŠÙØ­Øµ canSend (Cooldown)
    â†“
ÙŠØ±Ø³Ù„ Ø§Ù„Ø·Ù„Ø¨ Ù„Ù„Ù€ Firebase
    â†“
Ø±Ø³Ø§Ù„Ø© Ù†Ø¬Ø§Ø­ ØªØ¸Ù‡Ø± + Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù€ 60 Ø«Ø§Ù†ÙŠØ© ÙŠØ¨Ø¯Ø£
    â†“
User ÙŠÙØªØ­ Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„ ÙˆÙŠØ¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„Ø±Ø§Ø¨Ø·
    â†“
User ÙŠØ¹ÙŠØ¯ ØªØ¹ÙŠÙŠÙ† ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø¹Ù„Ù‰ ØµÙØ­Ø© Firebase
    â†“
User ÙŠØ±Ø¬Ø¹ Ù„Ù„ØªØ·Ø¨ÙŠÙ‚ ÙˆÙŠØ³Ø¬Ù„ Ø¯Ø®ÙˆÙ„
```

### 2. Email Verification Flow (Ø¹Ù†Ø¯ Ø§Ù„ØªØ³Ø¬ÙŠÙ„)
```
User ÙŠÙ…Ù„Ø£ Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„ØªØ³Ø¬ÙŠÙ„
    â†“
ÙŠØ¶ØºØ· "Submit"
    â†“
SignUpProvider ÙŠÙ†Ø´Ø¦ Ø§Ù„Ø­Ø³Ø§Ø¨
    â†“
SignUpProvider ÙŠØ±Ø³Ù„ verification email ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹
    â†“
Navigation Ù„Ù€ EmailVerificationScreen
    â†“
Ø§Ù„Ø´Ø§Ø´Ø© ØªØ¨Ø¯Ø£ periodic check ÙƒÙ„ 5 Ø«ÙˆØ§Ù†
    â†“
User ÙŠÙØªØ­ Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„ (Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ ÙŠÙ†ØªÙ‚Ù„ Ù„Ù„Ø®Ù„ÙÙŠØ©)
    â†“
User ÙŠØ¶ØºØ· Ø¹Ù„Ù‰ Ø±Ø§Ø¨Ø· Ø§Ù„ØªØ­Ù‚Ù‚
    â†“
User ÙŠØ±Ø¬Ø¹ Ù„Ù„ØªØ·Ø¨ÙŠÙ‚ (AppLifecycleState.resumed)
    â†“
WidgetsBindingObserver ÙŠÙƒØªØ´Ù Ø§Ù„Ø¹ÙˆØ¯Ø©
    â†“
ÙŠØªÙ… ÙØ­Øµ Ø§Ù„ØªØ­Ù‚Ù‚ ÙÙˆØ±Ø§Ù‹ (checkVerificationStatus)
    â†“
isVerified = true
    â†“
Toast ÙŠØ¸Ù‡Ø± "Email verified successfully!"
    â†“
Navigation Ù„Ù€ ApplicationStatusGateRoute (Home)
```

### 3. Email Verification Check on App Start
```
App ÙŠØ¨Ø¯Ø£
    â†“
CheckAuthProvider ÙŠØ¹Ù…Ù„
    â†“
ÙŠØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ user
    â†“
ÙŠØ³ØªØ¯Ø¹ÙŠ checkEmailVerified()
    â†“
AuthRepo ÙŠØ³ØªØ¯Ø¹ÙŠ reloadUser() (Server-side)
    â†“
Ø¥Ø°Ø§ Email ØºÙŠØ± Ù…Ø­Ù‚Ù‚:
    â†“
ÙŠØ±Ù…ÙŠ EmailNotVerifiedException(email: user.email)
    â†“
Router ÙŠÙ„ØªÙ‚Ø· Ø§Ù„Ù€ Exception
    â†“
ÙŠÙˆØ¬Ù‡ Ù„Ù€ EmailVerificationRoute(email: email)
```

## âš ï¸ Ù†Ù‚Ø§Ø· Ù…Ù‡Ù…Ø© (Critical Points)

### 1. Server-side Verification
```dart
Future<bool> isEmailVerified() async {
  await reloadUser(); // âš ï¸ Ø¶Ø±ÙˆØ±ÙŠ Ø¬Ø¯Ø§Ù‹ Ù„ØªØ¬Ù†Ø¨ Ø§Ù„Ù€ cache
  return _firebaseAuth.currentUser?.emailVerified ?? false;
}
```
**Ù„Ù…Ø§Ø°Ø§ØŸ** Firebase Auth ÙŠØ®Ø²Ù† Ø­Ø§Ù„Ø© Ø§Ù„Ù€ `emailVerified` ÙÙŠ Ø§Ù„Ù€ cache Ø§Ù„Ù…Ø­Ù„ÙŠ. ÙŠØ¬Ø¨ Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ `reloadUser()` Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„ÙØ¹Ù„ÙŠØ© Ù…Ù† Ø§Ù„Ø³ÙŠØ±ÙØ±.

### 2. Timer Disposal
```dart
ref.onDispose(() {
  _periodicTimer?.cancel(); // âš ï¸ Ø¶Ø±ÙˆØ±ÙŠ Ù„ØªØ¬Ù†Ø¨ Memory leaks
});
```

### 3. Navigation Pattern
```dart
// âœ… Ø§Ø³ØªØ®Ø¯Ù… replace() Ø¨Ø¹Ø¯ Ø§Ù„ØªØ³Ø¬ÙŠÙ„
EmailVerificationRoute(email: emailController.text).replace(context);

// âŒ Ù„Ø§ ØªØ³ØªØ®Ø¯Ù… go() Ù„Ø£Ù† Ø§Ù„Ù€ back button Ø³ÙŠØ±Ø¬Ø¹ Ù„Ù„Ù€ signup
EmailVerificationRoute(email: emailController.text).go(context);
```

### 4. Freezed Imports
```dart
// âš ï¸ ÙŠØ¬Ø¨ Ø§Ø³ØªÙŠØ±Ø§Ø¯ freezed_annotation
import 'package:freezed_annotation/freezed_annotation.dart';

// âš ï¸ ÙŠØ¬Ø¨ Ø¥Ø¶Ø§ÙØ© ÙƒÙ„Ø§ Ø§Ù„Ù€ parts
part 'forgot_password_provider.freezed.dart';
part 'forgot_password_provider.g.dart';
```

### 5. Silent vs Normal Check
```dart
// Silent check (ÙÙŠ Ø§Ù„Ø®Ù„ÙÙŠØ© - Ù„Ø§ ÙŠØ¸Ù‡Ø± loading)
checkVerificationStatus(silent: true);

// Normal check (ÙŠØ¸Ù‡Ø± loading indicator)
checkVerificationStatus(silent: false);
```

## ğŸ§ª Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±

### Test Cases

1. **Forgot Password**
   - âœ… Ø¥Ø±Ø³Ø§Ù„ Ø¥ÙŠÙ…ÙŠÙ„ ØµØ­ÙŠØ­
   - âœ… Ø¥Ø±Ø³Ø§Ù„ Ø¥ÙŠÙ…ÙŠÙ„ ØºÙŠØ± ØµØ­ÙŠØ­
   - âœ… Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ Ù‚Ø¨Ù„ Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„Ù€ cooldown
   - âœ… Ø§Ù„Ø¹Ø¯Ø§Ø¯ Ø§Ù„ØªÙ†Ø§Ø²Ù„ÙŠ ÙŠØ¹Ù…Ù„ Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­
   - âœ… Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ø®Ø·Ø£ ØªØ¸Ù‡Ø± Ø¨Ø§Ù„ØªØ±Ø¬Ù…Ø© Ø§Ù„ØµØ­ÙŠØ­Ø©

2. **Email Verification**
   - âœ… Ø§Ù„ØªØ³Ø¬ÙŠÙ„ â†’ Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ Ø§Ù„ÙÙˆØ±ÙŠ Ù„Ù€ Verification screen
   - âœ… Periodic check ÙŠØ¹Ù…Ù„ ÙƒÙ„ 5 Ø«ÙˆØ§Ù†
   - âœ… Lifecycle detection Ø¹Ù†Ø¯ Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„ØªØ·Ø¨ÙŠÙ‚
   - âœ… Toast ÙŠØ¸Ù‡Ø± Ø¹Ù†Ø¯ Ø§Ù„ØªØ­Ù‚Ù‚ Ø§Ù„Ù†Ø§Ø¬Ø­
   - âœ… Navigation Ù„Ù€ Home Ø¨Ø¹Ø¯ Ø§Ù„ØªØ­Ù‚Ù‚
   - âœ… Resend email Ù…Ø¹ cooldown
   - âœ… Wrong email logout

3. **Router Integration**
   - âœ… Refresh ÙŠØ¨Ù‚Ù‰ ÙÙŠ Ø§Ù„ØµÙØ­Ø© (Ù…Ø´ ÙŠØ±ÙˆØ­ login)
   - âœ… EmailNotVerifiedException ØªÙˆØ¬Ù‡ Ù„Ù€ Verification screen
   - âœ… CheckAuth ÙŠÙ†ØªØ¸Ø± verification Ù‚Ø¨Ù„ authentication

## ğŸ“¦ Build Commands

```bash
# ØªÙˆÙ„ÙŠØ¯ Ù…Ù„ÙØ§Øª Freezed Ùˆ Riverpod
dart run build_runner build --delete-conflicting-outputs

# ØªÙˆÙ„ÙŠØ¯ Ù…Ù„ÙØ§Øª Ø§Ù„ØªØ±Ø¬Ù…Ø©
flutter gen-l10n

# ØªØ´ØºÙŠÙ„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
flutter run -d chrome  # Ù„Ù„ÙˆÙŠØ¨
flutter run -d windows  # Ù„Ù„ÙˆÙŠÙ†Ø¯ÙˆØ²
flutter run  # Ù„Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„
```

## ğŸ› Troubleshooting

### Ù…Ø´ÙƒÙ„Ø©: Provider not found
```
Error: The method 'emailVerificationProvider' isn't defined
```
**Ø§Ù„Ø­Ù„:** ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„Ù…Ø³Ø§Ø± Ø§Ù„ØµØ­ÙŠØ­ Ù„Ù„Ù€ import
```dart
// âŒ Ø®Ø·Ø£
import '../providers/email_verification_provider.dart';

// âœ… ØµØ­ÙŠØ­
import '../../providers/email_verification_provider.dart';
```

### Ù…Ø´ÙƒÙ„Ø©: networkError not found
```
Error: There's no constant named 'networkError' in 'ServerExceptionType'
```
**Ø§Ù„Ø­Ù„:** Ø§Ø³ØªØ®Ø¯Ù… `noInternet` Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† `networkError`
```dart
// âŒ Ø®Ø·Ø£
if (e.type == ServerExceptionType.networkError)

// âœ… ØµØ­ÙŠØ­
if (e.type == ServerExceptionType.noInternet)
```

### Ù…Ø´ÙƒÙ„Ø©: Freezed files not generated
```
Error: Could not resolve annotation for `class ForgotPasswordState`
```
**Ø§Ù„Ø­Ù„:** Ø£Ø¶Ù imports Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© ÙˆØ´ØºÙ„ build_runner
```dart
import 'package:freezed_annotation/freezed_annotation.dart';

part 'forgot_password_provider.freezed.dart';
part 'forgot_password_provider.g.dart';
```
Ø«Ù…:
```bash
dart run build_runner build --delete-conflicting-outputs
```

## ğŸ¨ UI Screenshots Placeholders

### Forgot Password Screen
- Mobile view (Compact)
- Tablet view (Medium)
- Success state
- Error state
- Cooldown timer

### Email Verification Screen
- Initial state
- Checking state
- Wrong email banner
- Resend cooldown
- Success toast

## ğŸ“š Resources

- [Firebase Auth Documentation](https://firebase.google.com/docs/auth)
- [Riverpod Documentation](https://riverpod.dev/)
- [Freezed Package](https://pub.dev/packages/freezed)
- [go_router Documentation](https://pub.dev/packages/go_router)

## ğŸ‘¨â€ğŸ’» Developer Notes

### Performance Considerations
- Periodic timer ÙŠØªÙ… Ø¥ÙŠÙ‚Ø§ÙÙ‡ Ø¹Ù†Ø¯ Ø§Ù„ØªØ­Ù‚Ù‚ Ø§Ù„Ù†Ø§Ø¬Ø­
- Silent checks Ù„ØªØ¬Ù†Ø¨ Ø§Ù„Ù€ UI flickering
- Server-side verification Ù„Ø¶Ù…Ø§Ù† Ø§Ù„Ø¯Ù‚Ø©
- Cooldown Ù„ØªØ¬Ù†Ø¨ Rate limiting Ù…Ù† Firebase

### Security Notes
- Email verification Ø¥Ù„Ø²Ø§Ù…ÙŠØ© Ù‚Ø¨Ù„ Ø§Ù„Ø¯Ø®ÙˆÙ„
- Server-side check ÙŠÙ…Ù†Ø¹ bypass
- Rate limiting ÙŠÙ…Ù†Ø¹ spam
- Firebase handles email link security

### Future Improvements
- [ ] Ø¥Ø¶Ø§ÙØ© Phone verification
- [ ] Ø¥Ø¶Ø§ÙØ© 2FA
- [ ] Email verification reminder notifications
- [ ] Analytics Ù„ØªØªØ¨Ø¹ conversion rates
- [ ] A/B testing Ù„Ù„Ù€ UI variations

---

**Ø§Ù„ØªØ§Ø±ÙŠØ®:** 31 ÙŠÙ†Ø§ÙŠØ± 2026  
**Ø§Ù„Ù†Ø³Ø®Ø©:** 1.0.0  
**Ø§Ù„Ù…Ø·ÙˆØ±:** GitHub Copilot  
**Ø§Ù„Ø­Ø§Ù„Ø©:** âœ… Ù…ÙƒØªÙ…Ù„ ÙˆØ¬Ø§Ù‡Ø² Ù„Ù„Ø¥Ù†ØªØ§Ø¬
